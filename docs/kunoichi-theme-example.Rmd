---
title: "Örplast í hafinu við Ísland"
subtitle: "Helstu uppsprettur, magn og farleiðir"
author:   |
  <br><br>
  <span class="noem">Valtýr Sigurðsson</span>
  <br><br>
  <img src="images/tvologohex.png" width="15%" align="right" />
  <br><br>
  
date: "<br><br>2019-09-05, Uppfært: `r format(Sys.time(), '%e. %B %Y')`"
lang: is
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["kunoichi", "ninjutsu" , "assets/ninpo.css"]
    self_contained: false
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

layout: true
class: split-three with-thick-border

.column.bg-main1[.content[

# .orange[Hvað er örplast?]
.nopadding[
.img-fill[![](images/orplast_science.jpg)]
]
]]
.column.bg-main2[.content[
# .orange[Örplast] .black[á við um allar plastagnir smærri en] 
# .orange[<span class=" faa-tada animated " style=" display: -moz-inline-stack; display: inline-block; transform: rotate(0deg);"> 5 mm</span>]
<br>
# .orange[Það eyðist ekki.] .black[Ber með sér eiturefni] og .orange[nýjar tegundir] .black[á milli hafsvæða]
<br>
### .black[Sumar gerðir] .red[fljóta] .black[en aðrar] .red[sökkva] .black[eða mara í hálfu kafi í sjónum].
]]
.column.bg-main3[.content[
# .white[Erfitt] .yellow[að sjá] .white[ og vandasamt að] .yellow[rannsaka].
<br>
.img-fill[![](images/animated_plot.gif)]
# .orange[Hvaðan kemur örplast?]
]]

---
class: show-100

???
Þetta er sýni úr sjávarseti og þarna má sjá þræði úr fatnaði eða veiðarfærum og fleiri plastagnir sem hafa verið teknar frá öllu hinu gumsinu í sýninu.
---
class: show-110
count: false
???
Örplast er jafn fjölbreytt og plast er almennt og það er flest hannað til þess að endast
---
count: false

???
Við höfum ekki ennþá sammælst um standard aðferðir við að greina örplast

---

layout: false
class: split-33

.column.bg-main2[.content.vmiddle[
.center[
# Helstu uppsprettur
]
<br><br>
## `r anicon::nia("Bifreiðahjólbarðar", animate="burst", anitype="parent-hover")`
## `r anicon::nia("Vegmerkingar", animate="burst", anitype="parent-hover")`
## `r anicon::nia("Málning", animate="burst", anitype="parent-hover")`
## `r anicon::nia("Gervigras og leiksvæði", animate="burst", anitype="parent-hover")`
## `r anicon::nia("Þvottur", animate="burst", anitype="parent-hover")`
## `r anicon::nia("Snyrtivörur", animate="burst", anitype="parent-hover")`
## `r anicon::nia("Veiðarfæri", animate="burst", anitype="parent-hover")`
## `r anicon::nia("Rusl í fjörum", animate="burst")`
]]
.column[.content[
.center[
```{r echo=FALSE, message=FALSE, warning=FALSE, out.width="85%"}
knitr::include_graphics("images/samansetning.png")
```

]]]

---
layout: false
class: split-two with-border
.column.bg-main1[
  .split-two[
  .row.bg-white[.content.vmiddle[.center[
   `r anicon::cia("images/ALTA.png", animate="pulse", speed="slow", anitype="parent-hover", size=7)`
  ]]]
  .row.bg-white[.content.vmiddle[.center[
    `r anicon::cia("images/map.png", animate="pulse", speed="slow", anitype="parent-hover", size=20)`
  ]]]
  
]]
.column[.content[
```{r skolp, echo=FALSE, fig.align='center', message=FALSE, warning=FALSE, dev.args=list(bg="transparent"), out.width='100%'}

par(mar=c(4,4,4,2))

roundUpNice <- function(x, nice=c(1,2,4,5,6,8,10)) {
  if(length(x) != 1) stop("'x' must be of length 1")
  10^floor(log10(x)) * nice[[which(x <= 10^floor(log10(x)) * nice)[[1]]]]
} # https://stackoverflow.com/questions/6461209/how-to-round-up-to-the-nearest-10-or-100-or-x

skólptölur <- read.csv("skjol/skolp_urban.csv", sep="\t",encoding = "UTF-8")
skólptölur <- skólptölur[!is.na(skólptölur$Magn.skólps..pe..)& skólptölur$Magn.skólps..pe..>0,]
levels(skólptölur$Tegund.hreinsunar) <- c("Eins þreps","Ekki vitað","Engin","Ítarleg","Ítarleg","Ítarleg","Rotþrær","Tveggja þrepa","Tveggja þrepa") #Hreinsa gögnin
require(plyr)
svaedi <- ddply(skólptölur,.(Svæði,Tegund.hreinsunar),summarise,Magn=sum(Magn.skólps..pe..),.drop=F)
skólp_fylki <- matrix(svaedi$Magn,nrow = length(levels(as.factor(svaedi$Tegund.hreinsunar))),ncol = length(unique(svaedi$Svæði)),dimnames=list(levels(as.factor(svaedi$Tegund.hreinsunar)),levels(svaedi$Svæði)))

landshlutar <- c('(NV)','(NA)','(SA)','(SV)')
colnames(skólp_fylki) <- paste(unique(svaedi$Svæði),landshlutar,sep="\n")

litir <- c('#7ECEF0','white','#CB5600', '#7F7CAF','#28587B','seashell')
bp <- barplot(skólp_fylki,ylab='',xlab='',axes=F,beside=TRUE,ylim=c(0,max(skólp_fylki)*1.1))
abline(h=seq(0,roundUpNice(1.1*max(skólp_fylki)),roundUpNice(1.1*max(skólp_fylki))/5), col = 'lightgray', lty = 3)
barplot(skólp_fylki, main='Tegund skólphreinsunar', ylab="Magn (þúsundir pe.)", beside=TRUE, axes = F, col=litir ,ylim = c(0,max(skólp_fylki)*1.1),add=T);box()
axis(2,seq(0,roundUpNice(1.1*max(skólp_fylki)),roundUpNice(1.1*max(skólp_fylki))/5),labels = seq(0,roundUpNice(1.1*max(skólp_fylki))/1000,roundUpNice(1.1*max(skólp_fylki))/5000),las=2)
legend('topleft', levels(as.factor(svaedi$Tegund.hreinsunar)), fill=litir)
```
]]



???
Tegund skólphreinsunar skipt eftir fjórum flokkum náttúrulegra yfirborðsvatnshlota. Unnið upp úr samantekt á stöðu skólpmála á Íslandi árið 2014 [@Umhverfisstofnun2017].

Þegar losun örplasts á Íslandi er skoðuð er rétt að taka suðvestur horn landsins út fyrir sviga. Þar sem helsta farleið örplasts er með rennandi vatni er hér notast við skiptingu íslenska vatnaumdæmisins í fjögur meginvatnasvæði73. Á suðvesturhorni landsins er vatnasvæði sem rennur í Faxaflóa (sjá mynd 3.1). Á því svæði býr yfir 3/4 hlutar landsmanna3 og þar er summa árdagsumferðar rúmir 3/4 hlutar á landsvísu. Flatarmál bygginga þar er yfir 50% flatarmáls allra bygginga á landsvísu74 en flatarmál málaðra flata eflaust enn meiri vegna byggingarhæðar. Flestir landsmenn fara til Reykjavíkur reglulega til að sækja þjónustu sem þar er í boði, nær allar vöruflutningar eru um svæðið og nærri allt millilandaflug. Þrír stórir slippir af fjórum eru á Höfuðborgarsvæðinu og í Grindavík. Það er því rík ástæða til að skoða þetta svæði betur.

Mynd birt með góðfúslegu leyfi Alta


---

layout: false
class: split-33

.column.bg-main2[.content.vmiddle[
.center[
# Helstu uppsprettur

<br><br>
Magn
]]]
.column[.content[
.center[
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, out.height="100%"}
#losun <- (l+h)/2 #Meðaltal lægra og hærra mats á losun.
value <- c(371, 41, 26, 33.2, 60, 3, 0.2, 8.2, 0.34, 1, 0.002) #Uppspretta lægra mat
losun <- c(164, 5.7,  0, 15.2, 3.2, 0.3, 0, 8.2, 0.34, 0, 0.002) #losun lægra mat
#value <- c(379,586,38,233,21,48,3,11,8,32,0.3,3)
heiti <- c('Bifreiðahjólbarðar',
          'Vegmerkingar',
          'Flugvélahjólbarðar',
          'Húsamálning',
          'Skipamálning',
          'Gervigras',
          'Leikvellir',
          'Þvottur',
          'Snyrtivörur',
          'Haglaskot',
          'Sigvatn')
land <- value-losun
df <- data.frame(heiti,land,losun)
df <- df[order(df$heiti),]

library(networkD3)
nodes <- c(levels(df$heiti), 'Land','Haf')
nodes <- as.data.frame(nodes)
names(nodes) <- "name"

a <- list()
for (i in 1:nrow(df)) {
  a[i] <- list(rbind(matrix(c(df[i,c(2,3)]))))
}
b <- do.call(c,a)
value <- unlist(b)

links <- 
  data.frame(
    source=c(0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10),
    target=c(rep(c(11,12),11)),
    value=value)


Sank <- list(nodes, links)
names(Sank) <- c('nodes', 'links')
sn <- sankeyNetwork(
  Links = Sank$links,
  Nodes = Sank$nodes,
  Source = "source",
  Target = "target",
  Value = "value",
  NodeID = "name",
  units = "tonn",
  colourScale = JS("d3.scaleOrdinal(d3.schemeCategory20);"),
  fontSize = 20,
  nodeWidth = 30, height = "681px", fontFamily = "Courier"
)
rammi <- widgetframe::frameWidget(sn)
rammi

```

]]]

???
fig.cap='Helstu uppsprettur örplasts á Íslandi og skipting þess eftir farleiðum í haf eða í jarðveg. Byggt á lægra mati.',

---

layout: true
class: split-two with-border border-white

.column.bg-main3[.content[
  .split-five[
 .row[.content[
`Dekkjakurl berst til hafs í gegnum ræsi í þéttbýli en festist að mestu í jarðveginum við vegina`
 ]]
  .row[.content[
`Vegmerkingar berast með sömu leiðum til hafs`
 ]]
  .row[.content[
`Útimálning berst einnig með affallsvatni gegnum ræsi en innimálningu er gjarnan hellt` `r anicon::nia("beint í sjóinn", animate="pulse")`
 ]]
  .row[.content[
`Bæði eyðing á „grasinu“ sjálfu og dekkjakurl sem berst í ræsi`
 ]]
   .row[.content[
 `Snyrtivörur; aðallega handsápa af verkstæðum `
 ]]
 ]
]]

.column.bg-white[.content.center.vmiddle[
{{content}}
]]

???
Define the layout and for sequence hide the appropriate cell.

---

class: hide-row2-col1 hide-row3-col1 hide-row4-col1 hide-row5-col1 with-thick-border border-white

```{r dekk, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, out.height="100%"}
value=c(244,34,22,79) 
losun=c(106,15,9,34)
land=value-losun


heiti <- c("Fólksbifreiðar ","Sendibifreiðar ","Hópbifreiðar ","Vörubifreiðar ")
df <- data.frame(heiti,land,losun)
df <- df[order(df$heiti),]
nodes <- c(levels(df$heiti), 'Land','Haf')
nodes <- as.data.frame(nodes)
names(nodes) <- "name"

a <- list()
for (i in 1:nrow(df)) {
  a[i] <- list(rbind(matrix(c(df[i,c(2,3)]))))
}
b <- do.call(c,a)
value <- unlist(b)

links <- 
  data.frame(
    source=rep(seq(0,length(heiti)-1),each=2),
    target=c(rep(c(length(heiti),length(heiti)+1),length(heiti))),
    value=value)
	
Sank <- list(nodes, links)
names(Sank) <- c('nodes', 'links')
sn <- sankeyNetwork(
  Links = Sank$links,
  Nodes = Sank$nodes,
  Source = "source",
  Target = "target",
  Value = "value",
  NodeID = "name",
  units = "tonn",
  colourScale = JS("d3.scaleOrdinal(d3.schemeCategory20);"),
  fontSize = 20,
  nodeWidth = 30, width = "770px", height = "500px", fontFamily = "Courier"
)
rammi <- widgetframe::frameWidget(sn)
rammi

```

???

Stærsta uppspretta örplasts í umhverfinu á Íslandi, sem lagt var mat á, er tengd bifreiðaumferð. Slit á dekkjum og vegmerkingum er um 60-85% örplastslosunar á Íslandi. 
Næst þar á eftir kemur húsamálning
Skipamálning í stóru slippunum er stór uppspretta í mikilli nálægð við hafið (fer eftir vinnubrögðum við málun og ekki síst þrif hversu mikið lendir í hafinu)
---

class: fade-row1-col1 hide-row3-col1 hide-row4-col1 hide-row5-col1 with-thick-border border-white
count: false

```{r vegmerkingar, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, out.height="100%"}
nodes <- c('Stærri sveitarfélög ','Minni sveitarfélög ','Vegagerðin ','Sprautuplast ','Vegamálning ','Uppspretta lægra mat ','Uppspretta hærra mat ','Losun í haf lægra mat','Losun í haf hærra mat')
nodes <- as.data.frame(nodes)
names(nodes) <- "name"
#nodes$name <-  as.character(nodes$name)
links <- data.frame(source=c(0,1,2,2,3,4,3,4,5,6),target=c(3,4,3,4,5,5,6,6,7,8),value=c(110,15,543,218,6,35,163,93,5.7,42.6))
rass <- list(nodes,links)
names(rass) <- c('nodes','links')
sn <- sankeyNetwork(Links = rass$links,
                    Nodes = rass$nodes,
                    Source = "source",
                    Target = "target",
                    Value = "value",
                    NodeID = "name",
                    units = "Tonn",
                    fontSize = 20,
                    nodeWidth = 30,
                    width = "770px",
                    height = "500px",
                    fontFamily = "Courier"
                    )
rammi <- widgetframe::frameWidget(sn)
rammi
```

---

class: fade-row1-col1 fade-row2-col1 hide-row4-col1 hide-row5-col1 with-thick-border border-white
count: false

```{r malning, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, out.height="100%"}
value <- c(30,3.2)
losun <- c(12,3.2)
heiti <- c("Útimálning","Innimálning")
land <- value-losun
df <- data.frame(heiti,land,losun)
df <- df[order(df$heiti),]

library(networkD3)
nodes <- c(levels(df$heiti), 'Land','Haf')
nodes <- as.data.frame(nodes)
names(nodes) <- "name"

a <- list()
for (i in 1:nrow(df)) {
  a[i] <- list(rbind(matrix(c(df[i,c(2,3)]))))
}
b <- do.call(c,a)
value <- unlist(b)

links <- 
  data.frame(
    source=rep(seq(0,length(heiti)-1),each=2),
    target=c(rep(c(length(heiti),length(heiti)+1),length(heiti))),
    value=value)


Sank <- list(nodes, links)
names(Sank) <- c('nodes', 'links')
sn <- sankeyNetwork(
  Links = Sank$links,
  Nodes = Sank$nodes,
  Source = "source",
  Target = "target",
  Value = "value",
  NodeID = "name",
  units = "tonn",
  colourScale = JS("d3.scaleOrdinal(d3.schemeCategory20);"),
  fontSize = 20,
  nodeWidth = 30, width = "770px", height = "500px", fontFamily = "Courier"
)
rammi <- widgetframe::frameWidget(sn)
rammi
```

---
class: fade-row1-col1 fade-row2-col1 fade-row3-col1 hide-row5-col1 with-thick-border border-white
count: false

```{r gervigras, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, out.height="100%"}
gervigras <- read.table("skjol/gervigras.csv",sep = ';',encoding = 'ISO 8859-1',header = T,dec = ',',stringsAsFactors = F)
gervigras$Ferm. <- as.numeric(gervigras$Ferm.)
gervigras$Gerð <- as.factor(gervigras$Gerð)
#motta <- gervigras[regexpr("motta",gervigras$Tegund.grass.og.fylliefnis)!=(-1),] #minnkar tap á kurli um 50%
#sand <- gervigras[regexpr("sand",gervigras$Tegund.grass.og.fylliefnis)!=(-1),]
gervigras$studull <- c()
gervigras[ rownames(gervigras[regexpr("motta",gervigras$Tegund.grass.og.fylliefnis)!=(-1),]),"studull"] <- "motta"
gervigras[ rownames(gervigras[regexpr("sand",gervigras$Tegund.grass.og.fylliefnis)!=(-1),]),"studull"] <- "sandur"

gervigras$kurl.lagt <- ifelse(is.na(gervigras$studull),gervigras$Ferm.*0.16,
                              ifelse(gervigras$studull=="motta",gervigras$Ferm.*0.16*0.5,0))
gervigras$kurl.hatt <- ifelse(is.na(gervigras$studull),gervigras$Ferm.*0.6,
                              ifelse(gervigras$studull=="motta",gervigras$Ferm.*0.6*0.5,0))
gervigras$slit.lagt <- gervigras$Ferm.*0.8*0.005
gervigras$slit.hatt <- gervigras$Ferm.*1.4*0.008

library(plyr)
fermetrar <- ddply(gervigras,.(Gerð),summarise,m2=mean(Ferm.),slit.lagt=mean(slit.lagt)*0.001,slit.hatt=mean(slit.hatt)*0.001,kurl.lagt=mean(kurl.lagt)*0.001,kurl.hatt=mean(kurl.hatt)*0.001)

# "Æfingavellir og smærri hús" "Keppnishús"
# "Keppnisvellir"              "Sparkvellir"
# "Sparkvellir (KSÍ)"
library(networkD3)
nodes <- c(as.character(fermetrar$Gerð),
           "Slit lægra mat",
           "Slit hærra mat",
           "Gúmmíkurl lægra mat",
           "Gúmmíkurl hærra mat")
nodes <- as.data.frame(nodes)
names(nodes) <- "name"
#nodes$name <-  as.character(nodes$name)
links <- data.frame(source=rep(c(0,1,2,3,4),each=4),target=rep(5:8,5),value=matrix(t(fermetrar[1:5,3:6])))
rass <- list(nodes,links)
names(rass) <- c('nodes','links')
sn <- sankeyNetwork(Links = rass$links, Nodes = rass$nodes, Source = "source",Target = "target", Value = "value", NodeID = "name",units = "Tonn", fontSize = 20,nodeWidth = 30,width = "770px",height = "500px",fontFamily = "Courier")
rammi <- widgetframe::frameWidget(sn)
rammi
```

---
class: fade-row1-col1 fade-row2-col1 fade-row3-col1 fade-row4-col1 with-thick-border border-white
count: false

```{r homer, echo=FALSE, message=FALSE, warning=FALSE}
mynd <- knitr::include_graphics("images/sapa.jpg")
mynd
```

---
layout: false
class: bg-main1 

# Niðurstaða
.font2[
* .yellow[Jebbs] svona eridda maður
* Við getum .yellow[ekki] nokkuð gert í þessu
* þabbaraþannig... lestu bara skýrsluna!
]

## (or you may be able to figure out the features looking at the code)

## You'll find future updates [`r anicon::faa("github", animate="vertical")` here](https://github.com/emitanaka/ninja-theme) or <br>you'll hear about it [`r anicon::faa("twitter", animate="float")` here](https://twitter.com/statsgen).
